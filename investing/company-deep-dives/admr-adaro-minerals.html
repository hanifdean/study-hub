<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adaro Minerals (ADMR) ‚Äî Company Deep Dive</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }
  :root {
    --bg: #0f0f14;
    --surface: #171720;
    --surface-alt: #1f1f2a;
    --surface-hover: #242433;
    --border: #2a2a35;
    --border-alt: #333344;
    --text: #ece9e3;
    --text-secondary: #d5d1c7;
    --text-muted: #9a9488;
    --text-dim: #766f64;
    --text-dimmer: #5b554c;
    --accent: #f59e0b;
    --accent-soft: rgba(245, 158, 11, 0.14);
    --accent-glow: rgba(245, 158, 11, 0.2);
    --highlight: #fbbf24;
    --green: #34d399;
    --red: #f87171;
  }

  [data-theme="light"] {
    --bg: #f8f6f2;
    --surface: #ffffff;
    --surface-alt: #f5f3ef;
    --surface-hover: #faf8f5;
    --border: #e5e0d8;
    --border-alt: #d5d0c8;
    --text: #2c2a26;
    --text-secondary: #4a4640;
    --text-muted: #6b6560;
    --text-dim: #8a8580;
    --text-dimmer: #a5a09a;
    --accent: #d97706;
    --accent-soft: rgba(217, 119, 6, 0.1);
    --accent-glow: rgba(217, 119, 6, 0.15);
    --highlight: #b45309;
    --green: #059669;
    --red: #dc2626;
  }

  body {
    font-family: 'Inter', -apple-system, sans-serif;
    background: var(--bg);
    color: var(--text);
    padding: 40px 24px;
    min-height: 100vh;
    transition: background 0.3s ease, color 0.3s ease;
  }

  .page-layout {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    gap: 28px;
    align-items: flex-start;
  }

  .content { flex: 1; min-width: 0; }

  .container { max-width: 980px; }

  .top-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
  }

  .back-link {
    font-size: 13px;
    color: var(--text-muted);
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: color 0.2s;
  }
  .back-link:hover { color: var(--accent); }

  .theme-toggle {
    background: none;
    border: 1.5px solid var(--border);
    border-radius: 8px;
    padding: 6px 10px;
    cursor: pointer;
    font-size: 16px;
    color: var(--text-muted);
    transition: border-color 0.2s, color 0.2s;
  }
  .theme-toggle:hover { border-color: var(--accent); color: var(--accent); }

  h1 {
    font-size: 30px;
    font-weight: 800;
    margin-bottom: 8px;
    color: var(--highlight);
  }

  .subtitle {
    font-size: 14px;
    color: var(--text-dim);
    margin-bottom: 28px;
    font-weight: 500;
  }

  .section {
    margin-bottom: 32px;
    animation: fadeUp 0.6s ease-out both;
  }

  .section h2 {
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 24px;
  }

  .stats-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    margin-bottom: 24px;
  }

  .stat-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 18px;
  }

  .stat-card .label {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--text-muted);
    font-weight: 700;
  }
  .stat-card .value {
    margin-top: 10px;
    font-size: 20px;
    font-weight: 700;
  }
  .stat-card .note {
    margin-top: 6px;
    font-size: 12px;
    color: var(--text-dim);
  }

  .pill-row {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 10px;
  }
  .pill {
    font-size: 11px;
    font-weight: 600;
    padding: 4px 10px;
    border-radius: 999px;
    background: var(--surface-alt);
    border: 1px solid var(--border-alt);
    color: var(--text-muted);
  }

  .table-wrap {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 18px;
    overflow-x: auto;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
  }
  thead th {
    text-align: left;
    padding: 10px 12px;
    color: var(--text-muted);
    font-size: 11px;
    letter-spacing: 0.6px;
    text-transform: uppercase;
    border-bottom: 1px solid var(--border);
  }
  tbody td {
    padding: 12px;
    border-bottom: 1px solid var(--border);
  }
  tbody tr:last-child td { border-bottom: none; }
  tbody td.num { text-align: right; font-variant-numeric: tabular-nums; }
  tbody tr.highlight td { color: var(--highlight); font-weight: 600; }

  .two-col {
    display: grid;
    grid-template-columns: 1.1fr 0.9fr;
    gap: 18px;
  }

  .list {
    display: grid;
    gap: 10px;
    font-size: 13px;
    color: var(--text-secondary);
  }
  .list strong { color: var(--text); }

  .case-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
  }
  .case-card {
    border-radius: 14px;
    padding: 18px;
    border: 1px solid var(--border);
    background: var(--surface);
  }
  .case-card.bull { border-color: rgba(52, 211, 153, 0.4); background: rgba(52, 211, 153, 0.06); }
  .case-card.bear { border-color: rgba(248, 113, 113, 0.4); background: rgba(248, 113, 113, 0.05); }
  .case-card h3 { font-size: 14px; margin-bottom: 8px; }
  .case-card ul { padding-left: 16px; font-size: 12px; color: var(--text-secondary); line-height: 1.6; }

  .verdict {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.15), transparent);
    border: 1px solid rgba(245, 158, 11, 0.4);
  }

  /* Inline jargon links */
  .jargon {
    color: var(--accent);
    text-decoration: none;
    border-bottom: 1.5px dotted var(--accent);
    cursor: pointer;
    transition: color 0.2s, border-color 0.2s;
  }
  .jargon:hover { color: var(--highlight); border-color: var(--highlight); }
  .jargon-def { scroll-margin-top: 24px; }
  .jargon-def:target {
    outline: 2px solid var(--accent);
    outline-offset: 4px;
    border-radius: 10px;
    animation: jargon-flash 1.2s ease;
  }
  @keyframes jargon-flash {
    0%, 100% { outline-color: transparent; }
    20%, 80% { outline-color: var(--accent); }
  }
  .jargon-back {
    font-size: 11px;
    color: var(--text-muted);
    text-decoration: none;
    margin-left: 6px;
    opacity: 0.7;
    transition: opacity 0.2s, color 0.2s;
  }
  .jargon-back:hover { opacity: 1; color: var(--accent); }

  .section-nav {
    position: sticky;
    top: 96px;
    width: 220px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 16px;
    height: fit-content;
    max-height: calc(100vh - 140px);
    overflow: auto;
  }
  .section-nav-title {
    font-size: 11px;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--text-dim);
    margin-bottom: 10px;
    font-weight: 700;
  }
  .section-nav-links {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }
  .section-nav a {
    display: block;
    text-decoration: none;
    color: var(--text-muted);
    font-size: 13px;
    padding: 6px 8px;
    border-radius: 8px;
    border: 1px solid transparent;
    transition: color 0.2s, background 0.2s, border-color 0.2s;
  }
  .section-nav a:hover { color: var(--accent); border-color: var(--border); background: var(--surface-hover); }
  .section-nav a.active { color: var(--accent); background: var(--accent-soft); border-color: var(--accent); }

  html { scroll-behavior: smooth; }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @media (max-width: 900px) {
    .stats-grid { grid-template-columns: repeat(2, 1fr); }
    .two-col { grid-template-columns: 1fr; }
    .case-grid { grid-template-columns: 1fr; }
  }

  @media (max-width: 768px) {
    body { padding: 24px 16px; }
    .page-layout { flex-direction: column; gap: 12px; }
    .section-nav {
      position: sticky;
      top: 0;
      width: 100%;
      padding: 8px;
      border-radius: 12px;
      overflow-x: auto;
      overflow-y: hidden;
    }
    .section-nav-title { display: none; }
    .section-nav-links { flex-direction: row; gap: 8px; }
    .section-nav a {
      white-space: nowrap;
      font-size: 12px;
      padding: 6px 12px;
      border-radius: 999px;
      border-color: var(--border);
      background: var(--surface);
    }
    .section-nav a.active { border-color: var(--accent); background: var(--accent-soft); color: var(--accent); }
  }
</style>
</head>
<body>
<div class="page-layout">
  <nav class="section-nav" aria-label="Section navigation">
    <div class="section-nav-title">On this page</div>
    <div class="section-nav-links" id="section-nav-links"></div>
  </nav>
  <main class="content">
    <div class="container">
      <div class="top-bar">
        <a href="../../" class="back-link">‚Üê Back to Study Hub</a>
        <button class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark mode">
          <span id="theme-icon">‚òÄÔ∏è</span>
        </button>
      </div>

      <h1>Adaro Minerals (ADMR) ‚Äî Company Deep Dive</h1>
      <p class="subtitle">Met coal plus a North Kalimantan aluminium smelter pipeline. High-growth play.</p>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="label">Ticker</div>
          <div class="value">ADMR.JK</div>
          <div class="note">Met coal + aluminium</div>
        </div>
        <div class="stat-card">
          <div class="label">9M25 Revenue</div>
          <div class="value">Rp11.26T</div>
          <div class="note">Steel demand tailwind</div>
        </div>
        <div class="stat-card">
          <div class="label">9M25 Net Profit</div>
          <div class="value">Rp3.41T</div>
          <div class="note">High margin cycle</div>
        </div>
        <div class="stat-card">
          <div class="label">KAI Smelter</div>
          <div class="value">North Kalimantan</div>
          <div class="note">Phased ops 2025‚Äì26</div>
        </div>
      </div>

      <section class="section" id="company-overview">
        <h2>üè¢ Company Overview</h2>
        <div class="card">
          <p style="font-size:13px;color:var(--text-secondary);line-height:1.7;">
            Adaro Minerals (ADMR) is a metallurgical coal producer with five <a href="#jargon-ccow" class="jargon">CCoW</a> concessions in East and Central Kalimantan and a strategic pivot into downstream aluminium. The company is ~83.8% owned by ADRO and is building PT Kalimantan Aluminium Industry (<strong>KAI</strong>) in North Kalimantan. The smelter is positioned as a <a href="#jargon-green-aluminium" class="jargon">green aluminium</a> platform aligned with Indonesia‚Äôs <a href="#jargon-hilirisasi" class="jargon">hilirisasi</a> agenda.
          </p>
          <div class="pill-row">
            <span class="pill">Met coal for steel</span>
            <span class="pill">5 CCoW concessions</span>
            <span class="pill">KAI smelter pipeline</span>
            <span class="pill">North Kalimantan</span>
            <span class="pill">High-growth play</span>
          </div>
        </div>
        <div class="table-wrap" style="margin-top:16px;">
          <table>
            <thead>
              <tr>
                <th>Business Segments</th>
                <th class="num">Notes</th>
              </tr>
            </thead>
            <tbody>
              <tr class="highlight">
                <td>Metallurgical coal mining</td>
                <td class="num">Core earnings driver for steel supply chain</td>
              </tr>
              <tr>
                <td>Aluminium smelter (KAI)</td>
                <td class="num">Phased operations targeted end-2025 / early-2026</td>
              </tr>
              <tr>
                <td>Downstream optionality</td>
                <td class="num">Potential ~1.5M <a href="#jargon-tpa" class="jargon">tpa</a> green aluminium capacity</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section class="section" id="investment-thesis">
        <h2>‚úÖ Investment Thesis</h2>
        <div class="card verdict">
          <div class="list">
            <div><strong>High-growth play:</strong> Met coal demand from steel underpins margins and cash flow.</div>
            <div><strong>Downstream expansion:</strong> KAI smelter adds a new aluminium earnings stream.</div>
            <div><strong>Green aluminium optionality:</strong> Hydro-powered output can command premium pricing.</div>
            <div><strong>Policy tailwind:</strong> Indonesia‚Äôs <a href="#jargon-hilirisasi" class="jargon">hilirisasi</a> agenda supports local processing.</div>
          </div>
        </div>
      </section>

      <section class="section" id="business-segments">
        <h2>üß© Business Segments</h2>
        <div class="two-col">
          <div class="card">
            <h3 style="font-size:14px;margin-bottom:10px;">Metallurgical Coal Mining</h3>
            <div class="list">
              <div><strong>Assets:</strong> Five <a href="#jargon-ccow" class="jargon">CCoW</a> concessions in East &amp; Central Kalimantan.</div>
              <div><strong>Demand base:</strong> Steel mills and industrial buyers.</div>
              <div><strong>Recent trend:</strong> FY2024 production +30% YoY.</div>
            </div>
          </div>
          <div class="card">
            <h3 style="font-size:14px;margin-bottom:10px;">Aluminium Smelter (KAI)</h3>
            <div class="list">
              <div><strong>Location:</strong> North Kalimantan industrial zone.</div>
              <div><strong>Energy thesis:</strong> Hydro-powered for <a href="#jargon-green-aluminium" class="jargon">green aluminium</a> output.</div>
              <div><strong>Capacity:</strong> Targeted ~1.5M <a href="#jargon-tpa" class="jargon">tpa</a> at full ramp.</div>
              <div><strong>Status:</strong> Phased operations expected end-2025/early-2026.</div>
            </div>
          </div>
        </div>
      </section>

      <section class="section" id="growth-catalysts">
        <h2>üöÄ Growth Catalysts</h2>
        <div class="card">
          <div class="list">
            <div><strong>KAI commissioning:</strong> Start-up of smelter phases could materially lift earnings mix.</div>
            <div><strong>Hydro power availability:</strong> Mentarang <a href="#jargon-plta" class="jargon">PLTA</a> unlocks premium <a href="#jargon-green-aluminium" class="jargon">green aluminium</a> positioning.</div>
            <div><strong>Steel cycle support:</strong> Infrastructure and energy transition keep met coal demand resilient.</div>
            <div><strong>Downstreaming incentives:</strong> Fiscal/permits support for <a href="#jargon-hilirisasi" class="jargon">hilirisasi</a> projects.</div>
          </div>
        </div>
      </section>

      <section class="section" id="risks">
        <h2>‚ö†Ô∏è Risks</h2>
        <div class="card">
          <div class="list">
            <div><strong>Smelter execution:</strong> Delays or cost overruns on KAI would compress returns.</div>
            <div><strong>Commodity cyclicality:</strong> Met coal prices are volatile and tied to steel demand.</div>
            <div><strong>Capital intensity:</strong> Large capex needs could pressure free cash flow.</div>
            <div><strong>Regulatory shifts:</strong> Permitting and downstream policy changes could impact timelines.</div>
            <div><strong>Logistics exposure:</strong> Remote assets add shipping and infrastructure risk.</div>
          </div>
        </div>
      </section>

      <section class="section" id="primary-sources">
        <h2>üìö Primary Sources</h2>
        <div class="card">
          <div class="list">
            <div><strong>Annual Report 2024:</strong> <a href="https://www.idx.co.id/StaticData/NewsAndAnnouncement/ANNOUNCEMENTSTOCK/From_EREP/202504/3ef2a4a0e5_54295d5d0a.pdf" target="_blank" rel="noopener noreferrer">IDX filing (PDF)</a>.</div>
            <div><strong>Investor Relations:</strong> <a href="https://alamtriminerals.id/" target="_blank" rel="noopener noreferrer">alamtriminerals.id</a>.</div>
          </div>
        </div>
      </section>

      <section class="section" id="thesis-framework">
        <h2>üß† Thesis Framework</h2>
        <div class="case-grid">
          <div class="case-card bull">
            <h3>üêÇ Bull Case</h3>
            <ul>
              <li>High-growth met coal volumes and pricing.</li>
              <li>Aluminium smelter ramps on time, powered by hydro for green aluminium premiums.</li>
            </ul>
          </div>
          <div class="case-card">
            <h3>üìå Base Case</h3>
            <ul>
              <li>Steady met coal output with normalized pricing.</li>
              <li>Smelter slips to 2027 but remains financeable.</li>
            </ul>
          </div>
          <div class="case-card bear">
            <h3>üêª Bear Case</h3>
            <ul>
              <li>Met coal price crash hits cash flow.</li>
              <li>Smelter capex overruns dilute returns.</li>
            </ul>
          </div>
        </div>
      </section>

      <section class="section" id="thesis-killers">
        <h2>üß® Thesis Killers</h2>
        <div class="card">
          <div class="list">
            <div><strong>Met coal price &lt; $200/ton:</strong> Downturn erodes margins.</div>
            <div><strong>Smelter delayed &gt; 2027:</strong> Re-rating and payback pushed out.</div>
            <div><strong>PLTA Mentarang issues:</strong> Hydro bottlenecks threaten green aluminium thesis.</div>
            <div><strong>Aluminium price collapse:</strong> Weak downstream economics.</div>
          </div>
        </div>
      </section>

      <section class="section" id="kpis">
        <h2>üìà Key KPIs to Track</h2>
        <div class="card">
          <div class="list">
            <div><strong>Met coal production volume:</strong> Quarterly output and sales mix.</div>
            <div><strong>Smelter construction milestones:</strong> EPC progress, commissioning dates.</div>
            <div><strong>Aluminium price:</strong> LME spot and regional premiums.</div>
            <div><strong>Cash cost/ton:</strong> Unit mining cost trends.</div>
          </div>
        </div>
      </section>

      <section class="section" id="related-context">
        <h2>üîó Related Context</h2>
        <div class="card" style="display:flex;flex-direction:column;gap:14px;">
          <a href="adro-alamtri.html" style="display:flex;align-items:flex-start;gap:14px;padding:14px;background:var(--surface-alt);border-radius:12px;border:1px solid var(--border);text-decoration:none;transition:border-color 0.2s,transform 0.2s;" onmouseover="this.style.borderColor='var(--accent)';this.style.transform='translateX(4px)'" onmouseout="this.style.borderColor='var(--border)';this.style.transform='none'">
            <span style="font-size:24px;">üèóÔ∏è</span>
            <div>
              <div style="font-size:14px;font-weight:600;color:var(--text);">ADRO ‚Äî Alamtri Resources</div>
              <div style="font-size:12px;color:var(--text-muted);margin-top:4px;">Holdco parent with the ADMR stake and green energy pivot.</div>
            </div>
            <span style="margin-left:auto;color:var(--text-dim);font-size:14px;">‚Üí</span>
          </a>
          <a href="aadi-adaro-andalan.html" style="display:flex;align-items:flex-start;gap:14px;padding:14px;background:var(--surface-alt);border-radius:12px;border:1px solid var(--border);text-decoration:none;transition:border-color 0.2s,transform 0.2s;" onmouseover="this.style.borderColor='var(--accent)';this.style.transform='translateX(4px)'" onmouseout="this.style.borderColor='var(--border)';this.style.transform='none'">
            <span style="font-size:24px;">üî•</span>
            <div>
              <div style="font-size:14px;font-weight:600;color:var(--text);">AADI ‚Äî Thermal Coal Spin-off</div>
              <div style="font-size:12px;color:var(--text-muted);margin-top:4px;">High-dividend thermal coal pure play.</div>
            </div>
            <span style="margin-left:auto;color:var(--text-dim);font-size:14px;">‚Üí</span>
          </a>
        </div>
      </section>

      <section class="section" id="jargon">
        <h2>üìñ Jargon Decoder</h2>
        <div class="card">
          <div style="display:flex;flex-direction:column;gap:10px;">
            <div id="jargon-ccow" class="jargon-def" style="padding:10px;background:var(--surface-alt);border-radius:10px;">
              <strong style="color:var(--accent);">CCoW (Coal Contract of Work)</strong>
              <a href="#" class="jargon-back" onclick="history.back();return false;">‚Ü© back</a>
              <div style="font-size:12px;color:var(--text-muted);margin-top:4px;">Long-term mining concession license framework in Indonesia.</div>
            </div>
            <div id="jargon-met-coal" class="jargon-def" style="padding:10px;background:var(--surface-alt);border-radius:10px;">
              <strong style="color:var(--accent);">Met Coal (Metallurgical Coal)</strong>
              <a href="#" class="jargon-back" onclick="history.back();return false;">‚Ü© back</a>
              <div style="font-size:12px;color:var(--text-muted);margin-top:4px;">Coal used in steelmaking, typically higher quality and pricing than thermal coal.</div>
            </div>
            <div id="jargon-hilirisasi" class="jargon-def" style="padding:10px;background:var(--surface-alt);border-radius:10px;">
              <strong style="color:var(--accent);">Hilirisasi</strong>
              <a href="#" class="jargon-back" onclick="history.back();return false;">‚Ü© back</a>
              <div style="font-size:12px;color:var(--text-muted);margin-top:4px;">Indonesia‚Äôs downstreaming policy to process raw resources domestically.</div>
            </div>
            <div id="jargon-smelter" class="jargon-def" style="padding:10px;background:var(--surface-alt);border-radius:10px;">
              <strong style="color:var(--accent);">Smelter</strong>
              <a href="#" class="jargon-back" onclick="history.back();return false;">‚Ü© back</a>
              <div style="font-size:12px;color:var(--text-muted);margin-top:4px;">Industrial facility that refines ore into metal (aluminium in KAI‚Äôs case).</div>
            </div>
            <div id="jargon-tpa" class="jargon-def" style="padding:10px;background:var(--surface-alt);border-radius:10px;">
              <strong style="color:var(--accent);">tpa (tons per annum)</strong>
              <a href="#" class="jargon-back" onclick="history.back();return false;">‚Ü© back</a>
              <div style="font-size:12px;color:var(--text-muted);margin-top:4px;">Annual production capacity measurement.</div>
            </div>
            <div id="jargon-plta" class="jargon-def" style="padding:10px;background:var(--surface-alt);border-radius:10px;">
              <strong style="color:var(--accent);">PLTA</strong>
              <a href="#" class="jargon-back" onclick="history.back();return false;">‚Ü© back</a>
              <div style="font-size:12px;color:var(--text-muted);margin-top:4px;">Pembangkit Listrik Tenaga Air ‚Äî hydroelectric power plant.</div>
            </div>
            <div id="jargon-green-aluminium" class="jargon-def" style="padding:10px;background:var(--surface-alt);border-radius:10px;">
              <strong style="color:var(--accent);">Green Aluminium</strong>
              <a href="#" class="jargon-back" onclick="history.back();return false;">‚Ü© back</a>
              <div style="font-size:12px;color:var(--text-muted);margin-top:4px;">Low-carbon aluminium produced using renewable energy sources.</div>
            </div>
          </div>
        </div>
      </section>
      <p style="font-size:11px;color:var(--text-dimmer);margin-top:20px;">Sources: Indo Watchlist source notes (Feb 2026), ADRO/ADMR disclosures. This is research, not financial advice.</p>
    </div>
  </main>
</div>

<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  document.getElementById('theme-icon').textContent = next === 'dark' ? '‚òÄÔ∏è' : 'üåô';
  localStorage.setItem('theme', next);
}
(function() {
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
    document.addEventListener('DOMContentLoaded', () => {
      const icon = document.getElementById('theme-icon');
      if (icon) icon.textContent = saved === 'dark' ? '‚òÄÔ∏è' : 'üåô';
    });
  }
})();

function slugifyHeading(text) {
  return text
    .toLowerCase()
    .replace(/[^a-z0-9\s-]/g, '')
    .trim()
    .replace(/\s+/g, '-')
    .replace(/-+/g, '-');
}

function initSectionNav() {
  const navLinks = document.getElementById('section-nav-links');
  if (!navLinks) return;

  let headings = Array.from(document.querySelectorAll('.section h2'));
  if (!headings.length) {
    headings = Array.from(document.querySelectorAll('h2'));
  }
  if (!headings.length) return;

  headings.forEach((heading) => {
    if (!heading.id) {
      heading.id = slugifyHeading(heading.textContent || '');
    }
  });

  navLinks.innerHTML = '';
  headings.forEach((heading) => {
    const link = document.createElement('a');
    link.className = 'section-link';
    link.href = `#${heading.id}`;
    link.textContent = heading.textContent || '';
    navLinks.appendChild(link);
  });

  const linkMap = new Map();
  navLinks.querySelectorAll('a').forEach((link) => {
    const targetId = link.getAttribute('href').slice(1);
    linkMap.set(targetId, link);
    link.addEventListener('click', () => setActive(targetId));
  });

  function setActive(id) {
    linkMap.forEach((link) => {
      link.classList.remove('active');
      link.removeAttribute('aria-current');
    });
    const activeLink = linkMap.get(id);
    if (activeLink) {
      activeLink.classList.add('active');
      activeLink.setAttribute('aria-current', 'true');
    }
  }

  setActive(headings[0].id);

  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          setActive(entry.target.id);
        }
      });
    },
    { rootMargin: '-20% 0px -65% 0px', threshold: [0, 0.1, 0.5] }
  );

  headings.forEach((heading) => observer.observe(heading));
}

document.addEventListener('DOMContentLoaded', () => {
  initSectionNav();
});
</script>
</body>
</html>
